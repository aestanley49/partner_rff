---
title: "Stats for 10.30"
output:
  pdf_document: default
  word_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## GitHub Documents

This is an R Markdown format used for publishing markdown documents to GitHub. When you click the **Knit** button all R code chunks are run and a markdown file (.md) suitable for publishing to GitHub is generated.


Load data 

```{r pressure, echo=FALSE}
getwd()
setwd("/Users/annabellestanley/Desktop/Fall 2019/RFF part 2")
###telling computer which folder csv or excel files are in. Note have to specify that folder

number <- read.csv("number.csv")
sal <- read.csv("salafsky.csv")
##two data sets with names assigned
```



1a. Number of partners: 
  source: species info tab --> data set name: "number"
  Output: count the frequency of different numbers of partners (no species specific)
  Note: chose to do breaks = 53 becuase highest number of partners is 53
  
```{r}
partner <- (number$partner.no.total)
summary(partner)
table(partner)
###make histogram out of this
partnerhist <- hist(partner, main = "Toal number of partners for species", xlab = "Number of partners", breaks = 53)
print(partnerhist)
###need to calculate quantiles to see distribution? 
```



1b. Species specific information  
  source: species info tab --> data set name: "number"
  First attempt using ggplot
  Output: If try and have species names on y-axis, then can't modify text size. (command to do so is 
  coord_flip() but I am deleting this out of the code)
  
```{r}

library(ggplot2)
p <- ggplot(data=number, aes(x=Common.name, y=partner.no.total)) + geom_col() + 
  scale_x_discrete(labels = number$Common.name)
p + theme(axis.text.x = element_text(size=4, angle = 90)) + scale_y_continuous(expand = c(0,0))

```


1bi. Species specific information subsets
  source: species info tab --> data set name: "number"
  Taking subset from Taxa column --> source: Tyler's data sheet 1_11_19
  Output: subset species into 8 taxa, each subset was plotted
  Q: unsure how to correct x-axis 
  
```{r}

#subset taxa column into 8 phylogenies 
fplant <- subset(number, Taxa == 'Flowering Plant')
Crustacean <- subset(number, Taxa == 'Crustacean')
Insect <- subset(number, Taxa == 'Insect')
Amphibian <- subset(number, Taxa == 'Amphibian')
Fish <- subset(number, Taxa == 'Fish')
Bird <- subset(number, Taxa == 'Bird')
Mammal <- subset(number, Taxa == 'Mammal')
Snail <- subset(number, Taxa == 'Snail')
Reptile <- subset(number, Taxa == 'Reptile')

#make graphs of partner counts for each

#Flowering Plants
fp <- table(fplant$partner.no.total)
fplot <- barplot(fp, main = 'Flowering Plants', xlab = 'species name')
              ###Q: unsure how to adjust spacing along x-axis 
#Crustaceans
Crust <- table(Crustacean$partner.no.total)
cplot <- barplot(cplot, main = 'Crustacean', xlab = 'species name')
cplot
  #only one speceis with information? 
#Insect
insect <- table(Insect$partner.no.total)
iplot <- barplot(insect, main = 'Insect', xlab = 'species name')
#Amphibian
Amph <- table(Amphibian$partner.no.total)
Aplot <- barplot(Amph, main = 'Amphibian', xlab = 'species name')
#Fish
Fish <- table(Fish$partner.no.total)
fplot <- barplot(Fish, main = 'Fish', xlab = 'species name')
#Bird
Bird <- table(Bird$partner.no.total)
bplot <- barplot(Bird, main = 'Bird', xlab = 'species name')
#Mammal
Mamm <- table(Mammal$partner.no.total)
mplot <- barplot(Mamm, main = 'Mammal', xlab = 'species name')
#Snail
Snail <- table(Snail$partner.no.total)
splot <- barplot(Snail, main = 'Snail', xlab = 'species name')
#Reptile
Rep <- table(Reptile$partner.no.total)
rplot <- barplot(Reptile, main = 'Mammal', xlab = 'species name')




#Trial in ggplots
  ## got stuck using ggplot --> kept getting error with what I put in "aes" section of code
  ## also note, didn't have to subset before plotting so second line of code is where should start
library(ggplot2)
fp <- ggplot(data=number, aes(x=fplant, y=partner.no.total)) + geom_col() + 
  scale_x_discrete(labels = number$Common.name) + scale_y_continuous(expand = c(0,0))

fp <- ggplot(data=number, subset(number, Taxa =='Flowering Plant'), aes(Common.name, partner.no.total)

?ggplot
?aes
+ geom_col() + 
  scale_x_discrete(labels = number$Common.name)
p + theme(axis.text.x = element_text(size=4, angle = 90)) + scale_y_continuous(expand = c(0,0))

```


1c Agreements per species 
    Number of agreements for each species 
    Note, this is only for the partner counts, not for the Salafsky data 

```{r}

library(ggplot2)
p <- ggplot(data=number, aes(x=Common.name, y= agreement.no)) + geom_col() + 
  scale_x_discrete(labels = number$Common.name)
p + theme(axis.text.x = element_text(size=4, angle = 90)) + scale_y_continuous(expand = c(0,0))

```




2. Partner by species table
  Creates data table with 1s and 0s for each partner where 1 notes that parter works with species and     0 notes that species is absent for spcified partner
  Code runs with a number of errors but still seems to work? 
  Second part of code deletes extra columns from table 

```{r}
##this loop seperates parnters on same row by the comma and puts them in their own column 
library(readr)
trialother <- read_csv("~/Desktop/Fall 2019/RFF part 2/dataforloopattempt.csv")
View(trialother)

for (i in 1:nrow(trialother)) {
  #cat(i, "\n")
  dvec <- trimws(strsplit(trialother$`Who the partners are`[i],split=",")[[1]])
  for (dname in dvec) {
    if (dname%in%colnames(trialother)) {
      trialother[i, dname] <- 1              
    } else {
      trialother[dname] <- 0
      trialother[i, dname] <- 1                                     
    }
  }
}

# how to remove a column in r / delete column in R # this version will remove column in r by name 
trialother$`Conservation Plan_1` <- trialother$`notes_all_cleaning specific` <- trialother$'in cooperation (included in total unless stated otherwise) or other vague terms' <- trialother$`number of conservation agreements`<- NULL ;
  trialother$`total number of partners for species` <- trialother$`type of agreements (source of information)` <- NULL ; trialother$`List agency office (if given)`  <- trialother$`unspecified additional landowners` <- NULL ; 
    trialother$`If distinction between species specific partners and total agreement partners, list total agreement partners here` <- trialother$`note redundancy` <- NULL ; 
trialother$'"in cooperation" (included in total unless stated otherwise) or other vague terms' <- NULL
View(trialother)
partnerbyspeciestable <- trialother

```


trying to count the number of species that each partner works on 

```{r}

(subset(trialother, BLM == 1))

##now have species that BLM is working on, but how do this across all partners? 


```





